input {
 jdbc {
  jdbc_connection_string => "jdbc:postgresql://db:5432/${DB_NAME}"
  jdbc_user => "${DB_USER}"
  jdbc_password => "${DB_PASSWORD}"
  jdbc_driver_library => "/usr/share/logstash/logstash-core/jars/postgresql-42.6.2.jar"
  jdbc_driver_class => "org.postgresql.Driver"
  jdbc_paging_enabled => true
  statement => "SELECT score FROM online_match_results WHERE game_id > 0"
  schedule => "* * * * *"
 }
}


filter {
  mutate{
    copy => {"score" => "[@metadata][_score]"}
  }
}


output {
 elasticsearch {
   index => "score"
   hosts=> "${ELASTIC_HOSTS}"
   user=> "${ELASTIC_USER}"
   password=> "${ELASTIC_PASSWORD}"
   cacert=> "certs/ca/ca.crt"
 }
}

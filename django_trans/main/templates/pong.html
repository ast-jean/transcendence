{% extends 'base.html' %}
{% load static %}
{% block title %}Transcendence | Pong{% endblock %}
{% block content %}
<!-- SERVER STATUS DEBUG 
    <h4 id="ServerStatus">Server Status : <span style="color: red;">Disconnected</span></h4>
<button id="sendBtn">Send Message to Server</button>
<button id="connectBtn" type="button"><span id="btnText">Connect</span></button> -->

<!-- ThreeJs -->
<script type="importmap">
    {
        "imports": {
            "three": "https://unpkg.com/three@0.164.1/build/three.module.js",
            "three/addons/": "https://unpkg.com/three@0.164.1/examples/jsm/" 
      }
    }
</script>
<script src="{% static 'main/scripts/socket_pong.js' %}" type="module"></script>
<script src="{% static 'main/scripts/pong.js' %}" type="module"></script>
<script src="{% static 'main/scripts/chat.js' %}" type="module"></script>
<script src="{% static 'main/scripts/gameplay/player.js' %}" type="module"></script>
<script src="{% static 'main/scripts/gameplay/collision.js' %}" type="module"></script>
<script src="{% static 'main/scripts/gameplay/ball.js' %}" type="module"></script>
<script src="{% static 'main/scripts/gameplay/wall.js' %}" type="module"></script>
<script src="{% static 'main/scripts/gameplay/score.js' %}" type="module"></script>
<script src="{% static 'main/scripts/ui/ui_tournament.js' %}" type="module"></script>
<script src="{% static 'main/scripts/ui/ui_updates.js' %}" type="module"></script>
<script src="{% static 'main/scripts/utils/setter.js' %}" type="module"></script>
<script src="{% static 'main/scripts/websockets/socket_pong.js' %}" type="module"></script>
<script src="{% static 'main/scripts/gameplay/AIplayer.js' %}" type="module"></script>
<div id="editor">
	<div id="view" class="container">
		<!-- <script src="{% static 'main/scripts/split.min.js' %}" type="module"></script> -->
		<!-- <script src="{% static 'main/scripts/controls.js' %}" type="module"></script> -->
		<div class="row">
			<div class="col align-items-center align-self-center">
				<div id="gameCont" class="three-js-canvas d-flex justify-content-center align-items-center"></div>
				<div id="tournament-info" class="hud">
					<p id="tournamentRoom">Tournament Room: </p>
					<p id="connectedPlayers">Players Connected: 0/4</p>
				</div>
				<!-- Placeholder pour afficher les informations du tournoi -->
				<div id="tournament-info" class="tournament-section">
					<p id="tournamentRoom">Tournament Room: </p>
					<p id="connectedPlayers">Players Connected: 0/4</p>
				</div>

				<!-- Placeholder pour afficher la liste des joueurs dans le lobby -->
				<div id="playersList" class="tournament-section">
					<h3>Players in the lobby:</h3>
					<ul id="playerListUl">
						<!-- Les joueurs seront ajoutÃ©s ici dynamiquement -->
					</ul>
				</div>

				<!-- Bouton pour dÃ©marrer la partie -->
				<div id="startGameDiv" class="game-controls">
					<button id="startGameButton" class="game-button">Start Game</button>
				</div>

				<!-- Placeholder pour entrer l'ID du tournoi pour rejoindre -->
				<div id="tournamentRoomSearch" class="hidden tournament-section">
					<form id="roomSearchForm">
						<input type="text" id="roomIdInput" placeholder="Enter Tournament Room ID" />
						<button type="submit">Join Tournament</button>
					</form>
				</div>

				<!-- Placeholder pour afficher les scores -->
				<div id="tournament-scores" class="tournament-section hidden">
					<h3>Tournament Scores</h3>
					<div id="scoreboard">
						<!-- Les scores et rÃ©sultats seront affichÃ©s ici -->
					</div>
				</div>

				<div id="play_btns" class="hud"> <!-- text-center align-items-center align-self-center -->
					<div id="onlineplay_btn" class="hud-btn game-button">
							<b>Play online</b> <br>
							<small>(1vs1 / 2vs2)</small>
					</div>
					<div id="localplay_btn" class="hud-btn game-button ">
						<b>Local play</b>
						<br>
						<small>(1vs1)</small>
					</div>
					<div id="versusai_btn" class="hud-btn game-button">
						<b>Versus AI</b>
						<br>
							ðŸ¤–
					</div>

					<button type="button" id="tournament_btn" class="hud-btn game-button btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal">
						<b>Tournament</b><br>
						<small>(4 players)</small>
					</button>
					<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
						<div class="modal-dialog">
							<div class="modal-content">
								<div class="modal-header">
									<h5 class="modal-title" id="exampleModalLabel">Waiting for players...</h5>
									<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
								</div>
								<div class="modal-body row">
									<!-- <div class="container-fluid"></div> -->

									<div class="col" id="first-col"> 
										<div class="row"> 
											<div class="bracket m-2">
												<div class="mx-auto border border-black rounded" id="p1-row">
													<p class="my-auto mx-2 overflow-hidden mb-1">  ada </p>
												</div>
											</div>
										</div>
										<div class="row"> 
											<div class="bracket m-2">
												<div class="mx-auto border border-black rounded" id="p2-row">
													<p class="my-auto mx-2 overflow-hidden mb-1"> 12345678901234567890 </p>
												</div>
											</div>
										</div>
										<div class="row"> 
											<div class="bracket m-2">
												<div class="mx-auto border border-black rounded" id="p3-row">
													<p class="my-auto mx-2 overflow-hidden mb-1"> player 3 </p>
												</div>
											</div>
										</div>
										<div class="row"> 
											<div class="bracket m-2">
												<div class="mx-auto border border-black rounded" id="p4-row">
													<p class="my-auto mx-2 overflow-hidden mb-1"> player 4 </p>
												</div>
											</div>
										</div>
									</div>
							
									<!-- Second column: 2 winners -->
									<div class="col align-self-center" id="second-col"> 
										<!-- <div class=""> -->
											<div class="row ">
												<div class="bracket m-2">
													<div class="mx-auto border border-black rounded" id="W1-row">
														<p class="my-auto mx-2 mb-1"> winner 1 </p>
													</div>
												</div>
											</div>
											<div class="row">
												<div class="bracket m-2">
													<div class="mx-auto border border-black rounded" id="W2-row">
														<p class="my-auto mx-2  mb-1"> winner 2 </p>
													</div>
												</div>
											</div>
										<!-- </div> -->
									</div>
							
									<!-- Third column: winner final -->
									<div class="col align-self-center" id="third-col">
										<div class="row">
											<div class="bracket m-2">
												<div class="mx-auto border border-black rounded" id="WF-row">
													<p class="my-auto mx-2 mb-1"> winner final </p>
												</div>
											</div>
										</div>
									</div>
								<div class="modal-footer">
									<!-- FOOTER BUTTON NECESSARY ?? -->
									<button type="button" class="btn btn-secondary" data-bs-dismiss="modal"> Close </button>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div id="playersList"></div>
				<div id="tournamentOptions" class="hidden">
					<button id="startTournament">Commencer un tournoi</button>
					<button id="joinTournament">Rejoindre un tournoi</button>
				</div>
				<div id="tournamentRoomSearch" class="hidden">
					<h3>Enter Tournament Room ID</h3>
					<form id="roomSearchForm">
						<input type="text" id="roomIdInput" placeholder="Enter Room ID" required />
						<button type="submit">Join Tournament</button>
					</form>
				</div>
                <div id="layer2Btns" class="hidden">
                    <div id="OneVsOne" class="hud-btn">
                        <small>Create new (1vs1)</small>
                    </div>
                    <div id="TwoVsTwo" class="hud-btn ">
                        <small>Create new (2vs2)</small>
                    </div>
                    <form id="searchRoom">
						<input type="text" placeholder="enter room id #" name="searchRoom">
						<button type="hud-btn submit">Search</button>
					</form>
                </div>
				<div id="scoreboard flex-container">
                    <div id="roomIdDiv">
						<p id="roomId" class="text-white bg-dark">Room: </p>
					</div>
					<div>
						<div>Player 1:</div>
						<div id="player1Score"></div>
					</div>
					<div>
						<div>Player 2:</div>
						<div id="player2Score"></div>
					</div>
				</div>
				<div id="end-game-buttons" class="game-button" style="display: none;">
					<button id="replay-btn" class="btn btn-primary">Replay</button>
					<button id="menu-btn" class="btn btn-secondary">Menu</button>
					<p id="endGameMessage"></p>
				</div>
				<button id="randomize-colors-btn" class="play-button randomize-colors-btn">Randomize Colors</button>
			</div>
			<div id="chat-container" class="mt-3">
				<div id="chat-box">
					<ul id="chat-messages"></ul>
				</div>
				<input type="text" id="chat-input" placeholder="Type a message..." />
				<button id="chat-btn" class="btn btn-dark">
					<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="#ffffff" version="1.1" id="Capa_1" width="20px" height="30px" viewBox="0 0 220.682 220.682" xml:space="preserve">
						<g>
							<polygon points="92.695,38.924 164.113,110.341 92.695,181.758 120.979,210.043 220.682,110.341 120.979,10.639" />
							<polygon points="28.284,210.043 127.986,110.341 28.284,10.639 0,38.924 71.417,110.341 0,181.758" />
						</g>
					</svg>
				</button>
	        </div>
		</div>
	</div>
</div>
{% endblock %}
